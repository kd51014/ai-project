{% extends "base.html" %}
{% block title %}Home{% endblock %}
{% block content %}
{% if session.user_login %}
  <button id="showAddPost" class="primary">Add Post +</button>
{% endif %}

<div id="addPostModal">
  <form method="POST" enctype="multipart/form-data">
    <h2>New Post</h2>
    <label>Title:<input type="text" name="title" required></label>
    <label>Content:<textarea name="content" required></textarea></label>
    <label>Attach image:<input type="file" name="image" accept="image/*"></label>
    <button type="submit" class="primary">Add Post</button>
    <button type="button" id="hideAddPost" class="secondary">Cancel</button>
  </form>
</div>

<h2>Posts</h2>
{% if posts %}
<ul class="posts">
{% for post in posts %}
  <li>
    <a href="/post/{{ post.id }}"><b>{{ post.title }}</b></a>
    <p>{{ post.content[:200] }}{% if post.content|length>200 %}â€¦{% endif %}</p>
    {% if post.image_url %}<img src="{{ post.image_url }}" alt="post image">{% endif %}
    <small>by <a href="/users/{{ post.author.login }}">{{ post.author.login }}</a> | {{ post.created_at.strftime('%Y-%m-%d %H:%M') if post.created_at else '' }}</small>
  </li>
{% endfor %}
</ul>
{% else %}
<p>No posts yet.</p>
{% endif %}
{% endblock %}
